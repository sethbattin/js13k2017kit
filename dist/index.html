<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Game Zero ES6</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var GAME=function(){function e(e){return Math.sin(6.283184*e)}function t(t){return 0>e(t)?-1:1}function n(e){return e%1-.5}function r(e){var t=e%1*4;return 2>t?t-1:3-t}function a(e){return.00390625*Math.pow(1.059463094,e-128)}function i(e,t){setTimeout(function(){var n=new Uint8Array(e*c*2),r=n.length-2,a=function(){for(var e=new Date,i=0;r>=0;)if(n[r]=0,n[r+1]=128,r-=2,(i+=1)%1e3==0&&new Date-e>f)return void setTimeout(a,0);setTimeout(function(){t(n)},0)};setTimeout(a,0)},0)}function o(e,t,n,r,a){var i=n.fx_delay_time*r>>1,o=n.fx_delay_amt/255,s=0,l=function(){for(var n=new Date,r=0;t-i>s;){var c=4*s,u=4*(s+i),d=e[u]+(e[u+1]<<8)+(e[c+2]+(e[c+3]<<8)-32768)*o;if(e[u]=255&d,e[u+1]=d>>8&255,d=e[u+2]+(e[u+3]<<8)+(e[c]+(e[c+1]<<8)-32768)*o,e[u+2]=255&d,e[u+3]=d>>8&255,++s,(r+=1)%1e3==0&&new Date-n>f)return void setTimeout(l,0)}setTimeout(a,0)};setTimeout(l,0)}function s(){stats.begin();let e=(new Date).getTime();g.dt=Math.min(1,(e-g.last)/1e3),g.game.step(g.dt),g.last=e,g.game.render(),stats.end(),requestAnimationFrame(s)}ENGINE={E:this,screen:0,page1:65536,page2:131072,page3:196608,page4:262144,page5:327680,page6:393216,page7:458752,colors:[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],palDefault:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],pal:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],renderTarget:0,renderSource:65536,currentState:0,playSound:function(e,t,n,r){var a=u.createBufferSource(),i=u.createGain(),o=u.createStereoPanner();return a.buffer=e,a.connect(o),o.connect(i),i.connect(u.destination),a.playbackRate.value=t,a.loop=r,i.gain.value=1,o.pan.value=n,a.start(),{volume:i,sound:a}},gfx:{clear:function(e){g.ram.fill(e,g.renderTarget,g.renderTarget+65536)},pset:function(e,t,n){t|=0,(e|=0)>-1&&256>e&&t>-1&&256>t&&(g.ram[g.renderTarget+(256*t+e)]=n)},line:function(e,t,n,r,a){var i,o,s=(r|=0)-(t|=0),l=(n|=0)-(e|=0);if(0>s?(s=-s,o=-1):o=1,0>l?(l=-l,i=-1):i=1,s<<=1,l<<=1,this.pset(e,t,a),l>s)for(var c=s-(l>>1);e!=n;)0>c||(t+=o,c-=l),e+=i,c+=s,this.pset(e,t,a);else for(c=l-(s>>1);t!=r;)0>c||(e+=i,c-=s),t+=o,c+=l,this.pset(e,t,a)},circle:function(e,t,n,r){var a=-n,i=0,o=2-2*n;do{this.pset(e-a,t+i,r),this.pset(e-i,t-a,r),this.pset(e+a,t-i,r),this.pset(e+i,t+a,r),(n=o)>i||(o+=2*++i+1),(n>a||o>i)&&(o+=2*++a+1)}while(0>a)},fillCircle:function(e,t,n,r){e|=0,t|=0,r|=0;var a=-(n|=0),i=0,o=2-2*n;do{this.line(e-a,t-i,e+a,t-i,r),this.line(e-a,t+i,e+a,t+i,r),(n=o)>i||(o+=2*++i+1),(n>a||o>i)&&(o+=2*++a+1)}while(0>a)},rect:function(e,t,n,r,a){e|=0,n|=0,t|=0,r|=0,this.line(e,t,n,t,a),this.line(n,t,n,r,a),this.line(e,r,n,r,a),this.line(e,t,e,r,a)},fillRect:function(e,t,n,r,a){e|=0,n|=0,t|=0,r|=0;var i=Math.abs(r-t);if(g.gfx.line(e,t,n,t,a),i>0)for(;--i;)g.gfx.line(e,t+i,n,t+i,a);g.gfx.line(e,r,n,r,a)},triangle:function(e,t,n,r,a,i,o){g.gfx.line(e,t,n,r,o),g.gfx.line(n,r,a,i,o),g.gfx.line(a,i,e,t,o)},fillTriangle:function(e,t,n,r,a,i,o){var e=Math.round(16*e),n=Math.round(16*n),a=Math.round(16*a),t=Math.round(16*t),s=e-n,l=(r=Math.round(16*r))-t,c=n-a,f=(i=Math.round(16*i))-r,u=a-e,d=t-i,h=Math.max(Math.min(e,n,a)+15>>4,0),p=Math.min(Math.max(e,n,a)+15>>4,256),v=Math.max(Math.min(t,r,i)+15>>4,0),m=Math.min(Math.max(t,r,i)+15>>4,256);h&=-8,v&=-8;var y=-l*e-s*t,x=-f*n-c*r,w=-d*a-u*i;(l>0||0==l&&s>0)&&y++,(f>0||0==f&&c>0)&&x++,(d>0||0==d&&u>0)&&w++,y=y-1>>4,x=x-1>>4,w=w-1>>4;var _=0,S=0,M=0,T=0,A=0,D=0;0>s?_-=7*s:S-=7*s,0>l?_-=7*l:S-=7*l,0>c?M-=7*c:T-=7*c,0>f?M-=7*f:T-=7*f,0>u?A-=7*u:D-=7*u,0>d?A-=7*d:D-=7*d;for(var b=v;m>b;b+=8)for(var G=h;p>G;G+=8){var C=y+s*b+l*G,k=x+c*b+f*G,E=w+u*b+d*G;if(!(S>C||T>k||D>E)){var z=G+256*b;if(C<_||k<M||E<A)for(q=0;8>q;q++){for(var L=C,P=k,K=E,R=0;8>R;R++)0>(L|P|K)||(g.ram[g.renderTarget+z]=o),L+=l,P+=f,K+=d,z++;C+=s,k+=c,E+=u,z+=248}else for(var q=0;8>q;q++){for(R=0;8>R;R++,z++)g.ram[g.renderTarget+z]=o;z+=248}}}},spr:function(e=0,t=0,n=16,r=16,a=0,i=0,o=!1,s=!1){for(var l=0;r>l;l++)for(var c=0;n>c;c++)255>i+l&&255>a+c&&i+l>-1&&a+c>-1&&(o&s?g.ram[g.renderSource+(256*(t+(r-l))+e+(n-c))]>0&&(g.ram[g.renderTarget+(256*(i+l)+a+c)]=g.pal[g.ram[g.renderSource+(256*(t+(r-l))+e+(n-c))]]):s&&!o?g.ram[g.renderSource+(256*(t+(r-l))+e+c)]>0&&(g.ram[g.renderTarget+(256*(i+l)+a+c)]=g.ram[g.renderSource+(256*(t+(r-l))+e+c)]):o&&!s?g.ram[g.renderSource+(256*(t+l)+e+(n-c))]>0&&(g.ram[g.renderTarget+(256*(i+l)+a+c)]=g.ram[g.renderSource+(256*(t+l)+e+(n-c))]):o||s||g.ram[g.renderSource+(256*(t+l)+e+c)]>0&&(g.ram[g.renderTarget+(256*(i+l)+a+c)]=g.pal[g.ram[g.renderSource+(256*(t+l)+e+c)]]))},sspr:function(e=0,t=0,n=16,r=16,a=0,i=0,o=16,s=16,l=!1,c=!1){for(var f=n/o,u=r/s,d=0;s>d;d++)for(var h=0;o>h;h++)px=h*f|0,py=d*u|0,255>i+d&&255>a+h&&i+d>-1&&a+h>-1&&g.ram[g.renderSource+(256*(t+py)+e+px)]>0&&(g.ram[g.renderTarget+(256*(i+d)+a+h)]=g.ram[g.renderSource+(256*(t+py)+e+px)])},checker:function(e,t,n){var r=256,a=256,i=0,o=0;e=e||8,r/=t=t||8,a/=e;for(var s=0;e>s;++s)for(var l=0,c=t/2;c>l;++l)i=2*l*r+(s%2?0:r),o=s*a,g.gfx.fillRect(i,o,i+r,o+a,n)}},canvasInit:function(){g.canvas=document.getElementById("canvas"),g.ctx=canvas.getContext("2d"),g.canvas.width=window.innerWidth,g.canvas.height=window.innerHeight,g.ctx.imageSmoothingEnabled=!1,g.ctx.mozImageSmoothingEnabled=!1,g.smallcanvas=document.createElement("canvas"),g.smallctx=g.smallcanvas.getContext("2d"),g.smallcanvas.width=256,g.smallcanvas.height=256,g.canvasHeight=g.smallcanvas.height,g.canvasWidth=g.smallcanvas.width,g.imageData=g.smallctx.getImageData(0,0,g.canvasWidth,g.canvasHeight),g.buf=new ArrayBuffer(g.imageData.data.length),g.buf8=new Uint8ClampedArray(g.buf),g.data=new Uint32Array(g.buf),g.ram=new Uint8ClampedArray(524288),g.renderTarget=g.screen},render:function(){for(var e=65536;e--;)g.data[e]=g.colors[g.pal[g.ram[e]]];g.imageData.data.set(g.buf8),g.smallctx.putImageData(g.imageData,0,0),g.compositeSize=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,g.compositeOrigin=(window.innerWidth-g.compositeSize)/2|0,g.ctx.imageSmoothingEnabled=!1,g.ctx.mozImageSmoothingEnabled=!1,g.ctx.drawImage(g.smallcanvas,0,0,255,255,g.compositeOrigin,0,g.compositeSize,g.compositeSize)},switchState:function(e){arguments.length>0?app.setState(g.states[e]):(g.currentState+=1,g.currentState>g.states.length-1&&(g.currentState=0),app.setState(g.states[g.currentState]))}};g=ENGINE;Number.prototype.map=function(e,t,n,r){return(this-e)*(r-n)/(t-e)+n},g.assets={song:{rowLen:5513,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1],c:[{n:[135,0,0,0,147,0,0,145,0,0,147,0,0,142,0,0,135,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:9}};var l={},c=2,f=33,u=null,d=[e,t,n,r];l.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/c/2},l.AudioGenerator.prototype.getWave=function(){var e,t,n,r,a,i,o,s=this.mixBuf,l=this.waveSize*c*2;for(i=(a=l-8)-36,r=String.fromCharCode(82,73,70,70,255&a,a>>8&255,a>>16&255,a>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&i,i>>8&255,i>>16&255,i>>24&255),e=0;l>e;){for(n="",t=0;256>t&&l>e;++t,e+=2)o=-32768>(o=4*(s[e]+(s[e+1]<<8)-32768))?-32768:o>32767?32767:o,n+=String.fromCharCode(255&o,o>>8&255);r+=n}return r},l.AudioGenerator.prototype.getAudio=function(){var e=this.getWave(),t=new Audio("data:audio/wav;base64,"+btoa(e));return t.preload="none",t.load(),t},l.AudioGenerator.prototype.getAudioBuffer=function(e){null===u&&(u=new AudioContext);var t=this.mixBuf,n=this.waveSize*c*2,r=u.createBuffer(c,this.waveSize,44100),a=r.getChannelData(0),i=r.getChannelData(1),o=0,s=function(){for(var l=new Date,c=0;n/2>o;){var u=4*(t[4*o]+(t[4*o+1]<<8)-32768);if(u=-32768>u?-32768:u>32767?32767:u,a[o]=u/32768,u=4*(t[4*o+2]+(t[4*o+3]<<8)-32768),u=-32768>u?-32768:u>32767?32767:u,i[o]=u/32768,o+=1,(c+=1)%1e3==0&&new Date-l>f)return void setTimeout(s,0)}setTimeout(function(){e(r)},0)};setTimeout(s,0)},l.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=d[e.lfo_waveform],this.osc1=d[e.osc1_waveform],this.osc2=d[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},l.SoundGenerator.prototype.genSound=function(t,n,r){new Date;for(var i=0,o=0,s=a(t+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),l=a(t+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),c=this.instr.fx_resonance/255,f=0,u=0,d=this.attack+this.sustain+this.release-1;d>=0;--d){var h=d+r,g=this.osc_lfo(h*this.lfoFreq)*this.instr.lfo_amt/512+.5,p=1;d<this.attack?p=d/this.attack:d<this.attack+this.sustain||(p-=(d-this.attack-this.sustain)/this.release);var v=s;this.instr.lfo_osc1_freq&&(v+=g),this.instr.osc1_xenv&&(v*=p*p),i+=v;var m=this.osc1(i)*this.instr.osc1_vol;v=l,this.instr.osc2_xenv&&(v*=p*p),o+=v,m+=this.osc2(o)*this.instr.osc2_vol,this.instr.noise_fader&&(m+=(2*Math.random()-1)*this.instr.noise_fader*p),m*=p/255;var y=this.instr.fx_freq;this.instr.lfo_fx_freq&&(y*=g);var x=c*(m-u)-(f+=(y=1.5*Math.sin(3.141592*y/44100))*u);switch(u+=y*x,this.instr.fx_filter){case 1:m=x;break;case 2:m=f;break;case 3:m=u;break;case 4:m=f+x}if(v=e(h*this.panFreq)*this.instr.fx_pan_amt/512+.5,m*=39*this.instr.env_master,(h*=4)+3<n.length){var w=n[h]+(n[h+1]<<8)+m*(1-v);n[h]=255&w,n[h+1]=w>>8&255,w=n[h+2]+(n[h+3]<<8)+m*v,n[h+2]=255&w,n[h+3]=w>>8&255}}},l.SoundGenerator.prototype.getAudioGenerator=function(e,t){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,r=this;i(n,function(a){r.genSound(e,a,0),o(a,n,r.instr,r.rowLen,function(){t(new l.AudioGenerator(a))})})},l.SoundGenerator.prototype.createAudio=function(e,t){this.getAudioGenerator(e,function(e){t(e.getAudio())})},l.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},l.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},l.MusicGenerator.prototype.generateTrack=function(e,t,n){var r=this;i(this.waveSize,function(a){var i=r.waveSize,s=r.waveSize*c*2,u=r.song.rowLen,d=r.song.endPattern,h=new l.SoundGenerator(e,u),g=0,p=0,v=0,m=function(){for(var t=new Date;;)if(32!==v){if(p===d-1)return void setTimeout(y,0);var n=e.p[p];if(n){var r=e.c[n-1].n[v];r&&h.genSound(r,a,g)}if(g+=u,v+=1,new Date-t>f)return void setTimeout(m,0)}else v=0,p+=1},y=function(){o(a,i,e,u,w)},x=0,w=function(){for(var e=new Date,r=0;s>x;){var i=t[x]+(t[x+1]<<8)+a[x]+(a[x+1]<<8)-32768;if(t[x]=255&i,t[x+1]=i>>8&255,x+=2,(r+=1)%1e3==0&&new Date-e>f)return void setTimeout(w,0)}setTimeout(n,0)};setTimeout(m,0)})},l.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;i(this.waveSize,function(n){var r=0,a=function(){r<t.song.songData.length?(r+=1,t.generateTrack(t.song.songData[r-1],n,a)):e(new l.AudioGenerator(n))};a()})},l.MusicGenerator.prototype.createAudio=function(e){this.getAudioGenerator(function(t){e(t.getAudio())})},l.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})};var h=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";n=e}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(e){e.preventDefault(),t(++n%r.children.length)},!1);var a=(performance||Date).now(),i=a,o=0,s=e(new h.Panel("FPS","#0ff","#002")),l=e(new h.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new h.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){a=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(l.update(e-a,200),e>i+1e3&&(s.update(1e3*o/(e-i),100),i=e,o=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:r,setMode:t}};h.Panel=function(e,t,n){var r=1/0,a=0,i=Math.round,o=i(window.devicePixelRatio||1),s=80*o,l=48*o,c=3*o,f=2*o,u=3*o,d=15*o,h=74*o,g=30*o,p=document.createElement("canvas");p.width=s,p.height=l,p.style.cssText="width:80px;height:48px";var v=p.getContext("2d");return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,c,f),v.fillRect(u,d,h,g),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(u,d,h,g),{dom:p,update:function(l,m){r=Math.min(r,l),a=Math.max(a,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,d),v.fillStyle=t,v.fillText(i(l)+" "+e+" ("+i(r)+"-"+i(a)+")",c,f),v.drawImage(p,u+o,d,h-o,g,u,d,h-o,g),v.fillRect(u+h-o,d,o,g),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(u+h-o,d,o,i((1-l/m)*g))}}},"object"==typeof module&&(module.exports=h),Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown:function(e){return this._pressed[e]},justReleased:function(e){return this._released[e]},onKeydown:function(e){this._pressed[e.keyCode]=!0},onKeyup:function(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update:function(){this._released={}}},Txt={textLine:function(e){gl=e.glitch||{};for(var t=e.text.length,n=0;t>n;n++)for(var r=Assets.letters[e.text.charAt(n)]||Assets.letters.unknown,a=0;5>a;a++)for(var i=0;5>i;i++)if(1===r[a][i]){var o=(Math.random()<gl.xch||0)*(Math.random()-.5)*gl.xamt||0,s=(Math.random()<gl.ych||0)*(Math.random()-.5)*gl.yamt||0;e.ctx.fillRect(e.x+i*e.scale+o+(5*e.scale+e.hspacing)*n,e.y+a*e.scale+s,e.scale,e.scale)}},text:function(e){var t=5*e.scale,n=e.text.split("\n"),r=n.slice(0),a=n.length,i=r.sort(function(e,t){return t.length-e.length})[0],o=i.length*t+(i.length-1)*e.hspacing,s=a*t+(a-1)*e.vspacing,l=e.x,c=e.y,f=e.x+o,u=e.y+s;"center"==e.halign?(l=e.x-o/2,f=e.x+o/2):"right"==e.halign&&(l=e.x-o,f=e.x),"center"==e.valign?(c=e.y-s/2,u=e.y+s/2):"bottom"==e.valign&&(c=e.y-s,u=e.y);var d=l+o/2,h=c+s/2;if(e.render)for(var g=0;a>g;g++){var p=n[g],v=p.length*t+(p.length-1)*e.hspacing,m=e.x,y=e.y+(t+e.vspacing)*g;"center"==e.halign?m=e.x-v/2:"right"==e.halign&&(m=e.x-v),"center"==e.valign?y-=s/2:"bottom"==e.valign&&(y-=s),e.snap&&(m=Math.floor(m),y=Math.floor(y)),this.textLine({ctx:e.ctx,x:m,y:y,text:p,hspacing:e.hspacing||0,scale:e.scale||1,glitch:e.glitch})}return{sx:l,sy:c,cx:d,cy:h,ex:f,ey:u,width:o,height:s}}},g.game={create:function(){g.sounds={},window.AudioContext=window.AudioContext||window.webkitAudioContext,u=new AudioContext,new l.MusicGenerator(g.assets.song).createAudioBuffer(function(e){g.sounds.song=e}),g.triangles=[];for(var e=0;2e3>e;e++){let e=255*Math.random()|0,t=255*Math.random()|0;g.triangles.push({x1:e+15*Math.random()*2-15,y1:t+15*Math.random()*2-15,x2:e+15*Math.random()*2-15,y2:t+15*Math.random()*2-15,x3:e+15*Math.random()*2-15,y3:t+15*Math.random()*2-15,color:31*Math.random()|0})}g.twoColorPalette=[0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],g.inversePalette=g.palDefault.slice().reverse(),g.warmPalette=[14,0,14,3,4,5,6,7,0,1,2,3,4,5,6,7,0,1,2,3,4,5,6,7,0,1,2,3,4,5,6,7],g.bgColor=0,g.fgColor=21,g.t=0,g.moveX=0,g.renderTarget=g.page2,g.gfx.fillRect(0,0,256,256,2),g.gfx.checker(16,16,1),g.player={x:128,y:128,radius:10,xvel:0,yvel:0,speed:6},g.drag=.97,g.songTrigger=!1,g.cursor={x:0,y:0}},resize:function(){g.canvas.width=window.innerWidth,g.canvas.height=window.innerHeight},step:function(e){g.t+=e,g.cos=Math.cos(e),g.sin=Math.sin(e);for(var t=0;t<g.triangles.length;t++){var n=g.triangles[t],r=n.x1+-128,a=n.x2+-128,i=n.x3+-128,o=n.y1+-128,s=n.y2+-128,l=n.y3+-128;g.triangles[t].x1=g.cos*r-g.sin*o+128,g.triangles[t].y1=g.sin*r+g.cos*o+128,g.triangles[t].x2=g.cos*a-g.sin*s+128,g.triangles[t].y2=g.sin*a+g.cos*s+128,g.triangles[t].x3=g.cos*i-g.sin*l+128,g.triangles[t].y3=g.sin*i+g.cos*l+128}g.player.x+=e*g.player.xvel,g.player.y+=e*g.player.yvel,g.player.xvel*=g.drag,g.player.yvel*=g.drag,Key.isDown(Key.a)&&(g.player.xvel-=g.player.speed),Key.isDown(Key.z)&&(g.songTrigger=!0),g.songTrigger&&(g.songTrigger=!1,g.playSound(g.sounds.song,1,1,1)),Key.isDown(Key.d)&&(g.player.xvel+=g.player.speed),Key.isDown(Key.w)&&(g.player.yvel-=g.player.speed),Key.isDown(Key.s)&&(g.player.yvel+=g.player.speed),g.player.x>256+2*g.player.radius&&(g.player.x=-g.player.radius),g.player.x<0-2*g.player.radius&&(g.player.x=256+g.player.radius),g.player.y>256+2*g.player.radius&&(g.player.y=-g.player.radius),g.player.y<0-2*g.player.radius&&(g.player.y=256+g.player.radius)},render:function(e){g.renderTarget=g.page1,g.gfx.fillRect(0,0,256,256,0);for(var t=0;t<g.triangles.length;t++)g.gfx.fillTriangle(g.triangles[t].x1,g.triangles[t].y1,g.triangles[t].x2,g.triangles[t].y2,g.triangles[t].x3,g.triangles[t].y3,g.triangles[t].color);g.gfx.circle(g.player.x,g.player.y,g.player.radius,21),g.renderSource=g.page2,g.renderTarget=g.page4,g.gfx.spr(0,0,256,256,0,0),g.renderSource=g.page1,g.gfx.spr(0,0,256,256,0,0),g.renderSource=g.page4,g.renderTarget=g.screen,g.gfx.spr(0,0,256,256),g.pal=g.warmPalette,g.moveX=64*Math.sin(g.t)|0,g.gfx.spr(64,64,128,128,64,64),g.pal=g.twoColorPalette,g.gfx.spr(0,0,64,64),g.gfx.spr(0,192,64,256,0,192),g.gfx.spr(192,192,256,256,192,192),g.gfx.spr(191,0,256,64,191,0),g.pal=g.palDefault,g.render()}};var g=ENGINE;init=function(){g.last=0,g.dt=0,g.now=0,stats=new h,document.body.appendChild(stats.dom),g.canvasInit(),g.game.create(),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),window.addEventListener("resize",g.game.resize),s()},window.onload=init()}();
</script></body></html>